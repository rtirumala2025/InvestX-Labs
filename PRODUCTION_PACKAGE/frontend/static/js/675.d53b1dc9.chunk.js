"use strict";(self.webpackChunkinvestx_labs=self.webpackChunkinvestx_labs||[]).push([[675],{9675:(e,s,t)=>{t.r(s),t.d(s,{default:()=>p});var l=t(7405),n=t(8878),a=t(3229),i=t(8330),r=t(8883),o=t(3909),d=t(1879),c=t(5875),u=t(9693),m=t(2486),x=t(782);const h={hidden:{opacity:0,y:16},visible:{opacity:1,y:0,transition:{duration:.6,ease:"easeOut"}}},p=()=>{const{lessonId:e}=(0,a.g)(),{courses:s,modules:t,lessons:p,quizzes:f,progress:v,markLessonComplete:g,loading:b,offline:j}=(0,u.O9)(),w=(0,n.useRef)(null),{queueToast:y}=(0,m.nm)(),[N,k]=(0,n.useState)(!1),[A,z]=(0,n.useState)({}),[q,C]=(0,n.useState)(!1),S=(0,n.useMemo)(()=>Object.values(p).flat(),[p]),O=(0,n.useMemo)(()=>S.find(s=>String(s.id)===String(e)),[S,e]),L=(0,n.useMemo)(()=>{if(!O)return null;return Object.values(t).flat().find(e=>String(e.id)===String(O.module_id))||null},[O,t]),M=(0,n.useMemo)(()=>L&&s.find(e=>String(e.id)===String(L.course_id))||null,[s,L]);(0,n.useEffect)(()=>{k(!!O&&"completed"===v[O.id])},[O,v]);const _=(0,n.useCallback)(async()=>{if(!O||N)return;const{success:e}=await g(O.id,"completed");e&&k(!0)},[O,N,g]);(0,n.useEffect)(()=>{const e=w.current;if(!e)return;const s=()=>{if(!e||N)return;const{scrollTop:s,scrollHeight:t,clientHeight:l}=e;s+l>=t-32&&_()};return e.addEventListener("scroll",s),()=>e.removeEventListener("scroll",s)},[_,N]);const E=(0,n.useMemo)(()=>{if(!O)return null;if(null!==f&&void 0!==f&&f[O.id])return f[O.id];if(O.quiz){if("string"===typeof O.quiz)try{return JSON.parse(O.quiz)}catch(e){return console.warn("\ud83d\udcd8 [LessonView] Unable to parse quiz JSON:",e),null}return O.quiz}return null},[O,f]),Q=(0,n.useMemo)(()=>E?Array.isArray(E)?E:Array.isArray(E.questions)?E.questions:null:null,[E]),B=(0,n.useCallback)((e,s)=>{z(t=>(0,l.A)((0,l.A)({},t),{},{[e]:s}))},[]),I=(0,n.useCallback)(async()=>{if(!O||null===Q||void 0===Q||!Q.length)return;if(Q.some((e,s)=>{var t;const l=null!==(t=e.id)&&void 0!==t?t:s;return void 0===A[l]}))return void y("Please answer every quiz question before submitting.","warning");const{success:e}=await g(O.id,"completed");e&&(k(!0),C(!0))},[O,Q,A,g]),P=(0,n.useMemo)(()=>null!==O&&void 0!==O&&O.content?"string"===typeof O.content?O.content.split(/\n{2,}/).filter(Boolean):Array.isArray(O.content)?O.content:"object"===typeof O.content?[JSON.stringify(O.content,null,2)]:[]:[],[O]),J="completed"===v[null===O||void 0===O?void 0:O.id];return(0,x.jsxs)("div",{className:"relative min-h-screen bg-gradient-to-b from-gray-950 via-gray-900 to-gray-950 text-white overflow-hidden",children:[(0,x.jsx)(r.P.div,{className:"absolute -top-24 -left-24 w-80 h-80 bg-gradient-to-r from-blue-500/30 to-purple-500/15 rounded-full blur-3xl",animate:{y:[0,18,0],x:[0,12,0]},transition:{repeat:1/0,duration:16,ease:"easeInOut"}}),(0,x.jsx)(r.P.div,{className:"absolute -bottom-32 -right-24 w-[22rem] h-[22rem] bg-gradient-to-r from-green-400/20 to-emerald-400/15 rounded-full blur-3xl",animate:{y:[0,-20,0],x:[0,-12,0]},transition:{repeat:1/0,duration:18,ease:"easeInOut"}}),(0,x.jsxs)("main",{className:"relative z-10 w-full max-w-5xl mx-auto px-3 lg:px-4 xl:px-6 py-4 lg:py-6",children:[b&&!O?(0,x.jsx)("div",{className:"flex justify-center py-24",children:(0,x.jsx)(c.Ay,{size:"large"})}):null,b||O?null:(0,x.jsxs)(o.A,{variant:"default",padding:"large",className:"text-center",children:[(0,x.jsx)("h2",{className:"text-2xl font-semibold text-white mb-2",children:"Lesson not found"}),(0,x.jsx)("p",{className:"text-sm text-white/60 mb-6",children:"We couldn\u2019t find the lesson you were looking for. It may have been moved or archived."}),(0,x.jsx)(d.A,{as:i.N_,to:"/education",variant:"primary",children:"\u2190 Back to Education"})]}),O&&(0,x.jsxs)(r.P.div,{variants:h,initial:"hidden",animate:"visible",className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,x.jsx)(d.A,{as:i.N_,to:"/education",variant:"glass",size:"small",children:"\u2190 Back to Education"}),J&&(0,x.jsx)("span",{className:"px-3 py-1 bg-green-500/20 text-green-200 text-xs rounded-full",children:"Completed"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:O.title}),(0,x.jsxs)("div",{className:"text-sm text-white/60 space-x-2",children:[M?(0,x.jsx)("span",{children:M.title}):null,L?(0,x.jsxs)("span",{children:["\u2022 ",L.title]}):null]})]}),(0,x.jsxs)(o.A,{variant:"floating",padding:"large",className:"shadow-xl",children:[(0,x.jsx)("div",{ref:w,className:"max-h-[60vh] overflow-y-auto pr-2 space-y-4 text-white/80 leading-relaxed tracking-wide",children:P.length?P.map((e,s)=>(0,x.jsx)("p",{className:"whitespace-pre-line",children:e},s)):(0,x.jsx)("p",{className:"text-white/60 text-sm",children:"Lesson content will be available soon. Check back later for new material."})}),(0,x.jsxs)("div",{className:"mt-6 flex flex-wrap gap-3",children:[(0,x.jsx)(d.A,{variant:"primary",onClick:_,disabled:N,children:N?"Lesson Completed":"Mark Lesson Complete"}),(0,x.jsx)(d.A,{as:i.N_,to:"/education",variant:"glass",children:"Browse Other Lessons"})]})]}),Q&&Q.length>0&&(0,x.jsxs)(o.A,{variant:"default",padding:"large",shadow:"large",className:"space-y-5",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"Quick Quiz"}),(0,x.jsx)("p",{className:"text-sm text-white/60",children:"Answer the questions below to check your understanding."})]}),(0,x.jsx)("div",{className:"space-y-4",children:Q.map((e,s)=>{var t;const l=null!==(t=e.id)&&void 0!==t?t:s,n=e.options||[];return(0,x.jsxs)("div",{className:"p-4 bg-white/5 border border-white/10 rounded-lg",children:[(0,x.jsxs)("p",{className:"text-sm font-medium text-white mb-3",children:[s+1,". ",e.question||"Answer the following:"]}),(0,x.jsx)("div",{className:"space-y-2",children:n.map((e,s)=>{var t,n,a;return(0,x.jsxs)("label",{className:"flex items-center space-x-2 text-sm text-white/80",children:[(0,x.jsx)("input",{type:"radio",name:"quiz-".concat(l),value:null!==(t=e.value)&&void 0!==t?t:e,checked:A[l]===(null!==(n=e.value)&&void 0!==n?n:e),onChange:()=>{var s;return B(l,null!==(s=e.value)&&void 0!==s?s:e)},className:"text-blue-500 focus:ring-blue-400"}),(0,x.jsx)("span",{children:null!==(a=e.label)&&void 0!==a?a:e})]},s)})})]},l)})}),(0,x.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,x.jsx)(d.A,{variant:"primary",onClick:I,disabled:N||q,children:N?"Quiz Completed":"Submit Quiz"}),q&&!N&&(0,x.jsx)("span",{className:"text-xs text-white/60",children:"Quiz submitted. Once graded, your progress will update automatically."})]})]})]})]})]})}}}]);